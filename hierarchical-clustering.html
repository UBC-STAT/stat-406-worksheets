<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>23 Hierarchical clustering | UBC Stat 406 Worksheets</title>
<meta name="author" content="Daniel J. McDonald and Matías Salibán-Barrera">
<meta name="description" content="Hierarchical clustering refers to a class of algorithms that work in a different way from the ones we have seen so far. Both k-means and model-based clustering try to find a pre-specified number...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="23 Hierarchical clustering | UBC Stat 406 Worksheets">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ubc-stat.github.io/stat-406-worksheets/hierarchical-clustering.html">
<meta property="og:description" content="Hierarchical clustering refers to a class of algorithms that work in a different way from the ones we have seen so far. Both k-means and model-based clustering try to find a pre-specified number...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="23 Hierarchical clustering | UBC Stat 406 Worksheets">
<meta name="twitter:description" content="Hierarchical clustering refers to a class of algorithms that work in a different way from the ones we have seen so far. Both k-means and model-based clustering try to find a pre-specified number...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">UBC Stat 406 Worksheets</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Stat 406 Worksheets</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li class="book-part">Module 0 – Review</li>
<li><a class="" href="predictions-using-a-linear-model.html"><span class="header-section-number">1</span> Predictions using a linear model</a></li>
<li class="book-part">Module 1 – Model Selection</li>
<li><a class="" href="predictions-using-a-linear-model-continued.html"><span class="header-section-number">2</span> Predictions using a linear model (continued)</a></li>
<li><a class="" href="cross-validation-concerns.html"><span class="header-section-number">3</span> Cross-validation concerns</a></li>
<li><a class="" href="comparing-models.html"><span class="header-section-number">4</span> Comparing models</a></li>
<li class="book-part">Module 2 – Regression</li>
<li><a class="" href="ridge-regression.html"><span class="header-section-number">5</span> Ridge regression</a></li>
<li><a class="" href="lasso.html"><span class="header-section-number">6</span> LASSO</a></li>
<li><a class="" href="non-parametric-regression.html"><span class="header-section-number">7</span> Non-parametric regression</a></li>
<li><a class="" href="kernel-regression-local-regression.html"><span class="header-section-number">8</span> Kernel regression / local regression</a></li>
<li><a class="" href="regression-trees.html"><span class="header-section-number">9</span> Regression trees</a></li>
<li><a class="" href="pruning-regression-trees-with-rpart.html"><span class="header-section-number">10</span> Pruning regression trees with rpart</a></li>
<li class="book-part">Module 3 – Classification</li>
<li><a class="" href="parametric-classifiers.html"><span class="header-section-number">11</span> Parametric classifiers</a></li>
<li><a class="" href="qda.html"><span class="header-section-number">12</span> QDA</a></li>
<li><a class="" href="classification-trees.html"><span class="header-section-number">13</span> Classification Trees</a></li>
<li class="book-part">Module 4 – Modern techniques</li>
<li><a class="" href="bagging-for-regression.html"><span class="header-section-number">14</span> Bagging for regression</a></li>
<li><a class="" href="bagging-for-classification.html"><span class="header-section-number">15</span> Bagging for classification</a></li>
<li><a class="" href="random-forests.html"><span class="header-section-number">16</span> Random Forests</a></li>
<li><a class="" href="boosting-a-statistical-learning-perspective.html"><span class="header-section-number">17</span> Boosting (a Statistical Learning perspective)</a></li>
<li><a class="" href="what-is-adaboost-doing-really.html"><span class="header-section-number">18</span> What is Adaboost doing, really?</a></li>
<li><a class="" href="single-layer-neural-network.html"><span class="header-section-number">19</span> Single layer neural network</a></li>
<li class="book-part">Module 5 – Unsupervised learning</li>
<li><a class="" href="introduction.html"><span class="header-section-number">20</span> Introduction</a></li>
<li><a class="" href="clustering.html"><span class="header-section-number">21</span> Clustering</a></li>
<li><a class="" href="model-based-clustering.html"><span class="header-section-number">22</span> Model based clustering</a></li>
<li><a class="active" href="hierarchical-clustering.html"><span class="header-section-number">23</span> Hierarchical clustering</a></li>
<li><a class="" href="references.html">References</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="alt-pca.html"><span class="header-section-number">A</span> PCA and alternating regression</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/ubc-stat/stat-406-worksheets">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="hierarchical-clustering" class="section level1">
<h1>
<span class="header-section-number">23</span> Hierarchical clustering<a class="anchor" aria-label="anchor" href="#hierarchical-clustering"><i class="fas fa-link"></i></a>
</h1>
<p>Hierarchical clustering refers to a class of algorithms that work in a
different way from the ones we have seen so far. Both k-means and model-based
clustering try to find a pre-specified number of clusters <em>simultaneously</em>.
Hierarchical methods are <em>agglomerative</em>–they start with <em>n</em> clusters
(one singleton cluster for each observation in the data set), and form a
hierarchical
sequence of clusters of sizes <em>n-1</em>, <em>n-2</em>, …, <em>3</em>, <em>2</em>, and a final “cluster”
composed of all the observations. The user then needs to decide where to
<em>cut</em> the sequence, in other words, how many clusters to identify.
Algorithms in this class are also called
agglomerative, for obvious reasons.</p>
<p>The general algorithm can be described as follows:</p>
<ol style="list-style-type: decimal">
<li>Set <em>K = n</em> (the number of observations in the data), and Start with <em>n</em> clusters;</li>
<li>While <em>K &gt; 1</em>:
<ol style="list-style-type: lower-alpha">
<li>Merge 2 clusters to form <em>K-1</em> clusters;</li>
<li>Set <code>K = K - 1</code> (i.e. decrease <em>K</em> by one).</li>
</ol>
</li>
</ol>
<p>The different versions (<em>flavours</em>) of this method are obtained
by varying the criteria to decide which 2 clusters to merge at each
run of step 2(i) above, which depends on how we measure the distance
(or dissimilarity) between clusters.</p>
<p>There are a few different tools to decide how many clusters may be present
in the data following a hierarchical clustering algorithm. The most
commonly used is a graphical representation of the sequence of
clusters, called a <em>dendogram</em>.</p>
<p>Please refer to your class notes for details on the different
merging criteria (i.e. deciding which clusters to combine
at each step)
and the interpretation of a dendogram. Below
we will illustrate the use of these algorithms on a few
examples.</p>
<div id="breweries-example" class="section level2">
<h2>
<span class="header-section-number">23.1</span> Breweries example<a class="anchor" aria-label="anchor" href="#breweries-example"><i class="fas fa-link"></i></a>
</h2>
<p>Beer drinkers were asked to rate 9 breweries on 26
attributes. The attributes were, e.g., Brewery has rich tradition; or
Brewery makes very good Pils beer. Relative to each attribute, the
informant had to assign each brewery a score on a 6-point scale
ranging from 1=not true at all to 6=very true.
We read the data, and use the function <code>dist</code>
to compute the pairwise <em>L_1</em> distances between
the 9 breweries. Note that the data are available
columnwise (<span class="math inline">\(p \times x\)</span>) so we first transpose
it before we compute the distances. We also
change the misleading column names assigned
by <code>read.table</code>, which are not features but
rather observation numbers:</p>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/breweries.dat"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Brew-"</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">x</span>, method <span class="op">=</span> <span class="st">"manhattan"</span><span class="op">)</span></code></pre></div>
<p>One implementation of hierarchical clustering methods in <code>R</code> is
in the function <code>hclust</code> in package <code>cluster</code>.
We first use Ward’s information criterion (corrected to
appropriately use squared distances). The <code>plot</code> method for objects
of class <code>hclust</code> produces the associated dendogram. The function <code>rect.hclust</code>
computes the height at which one shuld <em>cut</em> the dendogram to
obtain a desired number <em>k</em> of clusters. Below we show
the result for <em>K = 3</em> clusters:</p>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># hierarchical</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/">cluster</a></span><span class="op">)</span>
<span class="co"># show the dendogram</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, sub <span class="op">=</span> <span class="st">""</span>, hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="co"># identify 3 clusters</span>
<span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">cl</span>, k <span class="op">=</span> <span class="fl">3</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/breweries.2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Now we repeat the analysis but using Euclidean distances and <em>single linkage</em>,
and show <em>K = 3</em> clusters:</p>
<div class="sourceCode" id="cb356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">br.dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># L2</span>
<span class="va">br.hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">br.dis</span>, method <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">br.hc</span><span class="op">)</span>
<span class="va">br.hc.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">br.hc</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/breweries2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Note how these 3 clusters are somewhat different from the
ones found before. However, the <em>(V1, V4, V7)</em> cluster
is present in both partitions, and also the triplet
<em>(V3, V6, V8)</em> stays together as well.
It is interesting to compare these clusters with those
found by K-means (see previous notes), in particular,
these dendograms resemble
the information on the silhouette plots to some extent.</p>
</div>
<div id="languages-example" class="section level2">
<h2>
<span class="header-section-number">23.2</span> Languages example<a class="anchor" aria-label="anchor" href="#languages-example"><i class="fas fa-link"></i></a>
</h2>
<p>The details of this example were discussed in class. Here we
present the results of three commonly used merging
criteria:
<em>single</em> linkage, <em>complete</em> linkage, <em>average</em> linkage, and <em>Ward’s</em>
criterion. As usual, we start by reading
the data, which in this case
are the specific dissimilarities between languages
discussed in class, and we arrange them in a
matrix that can be used by <code>hclust</code>:</p>
<div class="sourceCode" id="cb357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/languages.dat"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"N"</span>, <span class="st">"Da"</span>, <span class="st">"Du"</span>, <span class="st">"G"</span>, <span class="st">"Fr"</span>, <span class="st">"S"</span>, <span class="st">"I"</span>, <span class="st">"P"</span>, <span class="st">"H"</span>, <span class="st">"Fi"</span><span class="op">)</span>
<span class="va">dd</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">dd</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="va">dd</span><span class="op">)</span></code></pre></div>
<p>Now we compute a hierarchical clustering sequence using <strong>single linkage</strong>,
plot the corresponding dendogram and identify 4 clusters:</p>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, sub <span class="op">=</span> <span class="st">""</span>, hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">cl</span>, k <span class="op">=</span> <span class="fl">4</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/langs2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Compare the above with the results obtained with <strong>complete linkage</strong>:</p>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="st">"complete"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, sub <span class="op">=</span> <span class="st">""</span>, hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">cl</span>, k <span class="op">=</span> <span class="fl">4</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/langs3-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>With <strong>average linkage</strong> we obtain:</p>
<div class="sourceCode" id="cb360"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, sub <span class="op">=</span> <span class="st">""</span>, hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">cl</span>, k <span class="op">=</span> <span class="fl">4</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/langs3.1-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>And finally, using <strong>Ward’s criterion</strong> results in the following
dendogram and 4 clusters:</p>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">d</span>, method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span>, sub <span class="op">=</span> <span class="st">""</span>, hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">cl</span>, k <span class="op">=</span> <span class="fl">4</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/langs4-1.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="cancer-example-1" class="section level2">
<h2>
<span class="header-section-number">23.3</span> Cancer example<a class="anchor" aria-label="anchor" href="#cancer-example-1"><i class="fas fa-link"></i></a>
</h2>
<p>Here we revisit the Cancer example discussed before. We use Euclidean
distances and Ward’s information criterion. Below we show the
clusters identified when we stop the algorithm at <em>K = 8</em>, which
based on the dendogram seems to be a reasonable choice:</p>
<div class="sourceCode" id="cb362"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">nci</span>, package <span class="op">=</span> <span class="st">"ElemStatLearn"</span><span class="op">)</span>
<span class="va">nci.dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">nci</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nci.hc.w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">nci.dis</span>, method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span>,
  main <span class="op">=</span> <span class="st">""</span>,
  xlab <span class="op">=</span> <span class="st">""</span>, sub <span class="op">=</span> <span class="st">""</span>, hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">nci</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">nci.hc.w</span>, k <span class="op">=</span> <span class="fl">8</span>, border <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/cancer-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>For completeness, below we show the results obtained with the other linkage criteria,
including Ward’s:</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nci.hc.s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">nci.dis</span>, method <span class="op">=</span> <span class="st">"single"</span><span class="op">)</span>
<span class="va">nci.hc.c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">nci.dis</span>, method <span class="op">=</span> <span class="st">"complete"</span><span class="op">)</span>
<span class="va">nci.hc.a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">nci.dis</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>

<span class="co"># plot them</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nci.hc.s</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">nci</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/cancer2-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb364"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nci.hc.c</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">nci</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/cancer2-2.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">nci.hc.a</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">nci</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/cancer2-3.png" width="90%" style="display: block; margin: auto;"></div>
<p>Note that with these 3 other criteria no clear structure
seems apparent in the data.</p>
</div>
<div id="nations-example" class="section level2">
<h2>
<span class="header-section-number">23.4</span> Nations example<a class="anchor" aria-label="anchor" href="#nations-example"><i class="fas fa-link"></i></a>
</h2>
<p>This is a smaller Political Science dataset. Twelve countries
were assessed on their perceived “likeness” by Political Science
students. Note that (as in the Languages example
above) in this example we do not have raw observations (features),
we only have access to the already determined parwise dissimilarities.
Below we show the results of using hierarchical clustering with complete and average
linkage merging criteria, which produce identical clusters. You
are encouraged to investigate what can be found with other
merging criteria.</p>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># read the pairwise dissimilarities</span>
<span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/nations2.dat"</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># since only the lower triangular matrix is available</span>
<span class="co"># we need to copy it on the upper half</span>
<span class="va">a2</span> <span class="op">&lt;-</span> <span class="va">a2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">a2</span><span class="op">)</span>

<span class="co"># create a vector of country names, to be used later</span>
<span class="va">nams2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"BEL"</span>, <span class="st">"BRA"</span>, <span class="st">"CHI"</span>, <span class="st">"CUB"</span>, <span class="st">"EGY"</span>, <span class="st">"FRA"</span>,
  <span class="st">"IND"</span>, <span class="st">"ISR"</span>, <span class="st">"USA"</span>, <span class="st">"USS"</span>, <span class="st">"YUG"</span>, <span class="st">"ZAI"</span>
<span class="op">)</span>

<span class="co"># compute hierarchical clustering using complete linkage</span>
<span class="va">na.hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="va">a2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"complete"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">na.hc</span>, labels <span class="op">=</span> <span class="va">nams2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/nations-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># compute hierarchical clustering using average linkage</span>
<span class="va">na.hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/dist.html">as.dist</a></span><span class="op">(</span><span class="va">a2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"average"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">na.hc</span>, labels <span class="op">=</span> <span class="va">nams2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/nations-2.png" width="90%" style="display: block; margin: auto;"></div>
</div>
<div id="un-votes" class="section level2">
<h2>
<span class="header-section-number">23.5</span> UN Votes<a class="anchor" aria-label="anchor" href="#un-votes"><i class="fas fa-link"></i></a>
</h2>
<p>We revisit here the UN votes example (see Lecture 19). Using Euclidean
distances and Ward’s criterion we obtain the following 3 clusters:</p>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">"data/unvotes.csv"</span>, sep <span class="op">=</span> <span class="st">","</span>, row.names <span class="op">=</span> <span class="fl">1</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">un.dis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span>
<span class="va">un.hc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">un.dis</span>, method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">un.hc</span>, cex <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
<span class="va">un.hc.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">un.hc</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/unvotes-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">un.hc.3</span>, <span class="va">names</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;  [1] "Australia"   "Austria"     "Belgium"     "Bulgaria"    "Canada"     </span>
<span class="co">#&gt;  [6] "Denmark"     "Finland"     "France"      "Greece"      "Hungary"    </span>
<span class="co">#&gt; [11] "Iceland"     "Ireland"     "Israel"      "Italy"       "Japan"      </span>
<span class="co">#&gt; [16] "Luxembourg"  "Netherlands" "New.Zealand" "Norway"      "Poland"     </span>
<span class="co">#&gt; [21] "Portugal"    "Spain"       "Sweden"      "UK"          "Ukraine"    </span>
<span class="co">#&gt; [26] "USA"        </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;  [1] "Argentina"  "Bahamas"    "Chile"      "Colombia"   "Costa.Rica"</span>
<span class="co">#&gt;  [6] "Cyprus"     "Malta"      "Mexico"     "Panama"     "Paraguay"  </span>
<span class="co">#&gt; [11] "Peru"       "Uruguay"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;  [1] "Algeria"              "Bangladesh"           "Belarus"             </span>
<span class="co">#&gt;  [4] "Bolivia"              "Botswana"             "Brazil"              </span>
<span class="co">#&gt;  [7] "Brunei.Darussalam"    "Burkina.Faso"         "China"               </span>
<span class="co">#&gt; [10] "Cuba"                 "Ecuador"              "Egypt"               </span>
<span class="co">#&gt; [13] "Ethiopia"             "Ghana"                "Guyana"              </span>
<span class="co">#&gt; [16] "India"                "Indonesia"            "Jamaica"             </span>
<span class="co">#&gt; [19] "Jordan"               "Kenya"                "Kuwait"              </span>
<span class="co">#&gt; [22] "Libya"                "Malaysia"             "Mali"                </span>
<span class="co">#&gt; [25] "Nepal"                "Nigeria"              "Pakistan"            </span>
<span class="co">#&gt; [28] "Philippines"          "Russian.Federation"   "Singapore"           </span>
<span class="co">#&gt; [31] "Sri.Lanka"            "Sudan"                "Syrian.Arab.Republic"</span>
<span class="co">#&gt; [34] "Tanzania"             "Thailand"             "Togo"                </span>
<span class="co">#&gt; [37] "Trinidad.and.Tobago"  "Venezuela"            "Zambia"</span></code></pre></div>
<p>If we repeat the same exercise but using <span class="math inline">\(L_1\)</span> distances we obtain
different clusters.</p>
<div class="sourceCode" id="cb370"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">un.dis.l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/dist.html">dist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"manhattan"</span><span class="op">)</span>
<span class="va">un.hc.l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/hclust.html">hclust</a></span><span class="op">(</span><span class="va">un.dis.l1</span>, method <span class="op">=</span> <span class="st">"ward.D2"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">un.hc.l1</span>, cex <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span>
<span class="va">un.hc.l1.3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/rect.hclust.html">rect.hclust</a></span><span class="op">(</span><span class="va">un.hc.l1</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/unvotes.l1-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">un.hc.l1.3</span>, <span class="va">names</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;  [1] "Australia"   "Austria"     "Belgium"     "Bulgaria"    "Canada"     </span>
<span class="co">#&gt;  [6] "Cyprus"      "Denmark"     "Finland"     "France"      "Greece"     </span>
<span class="co">#&gt; [11] "Hungary"     "Iceland"     "Ireland"     "Israel"      "Italy"      </span>
<span class="co">#&gt; [16] "Japan"       "Luxembourg"  "Malta"       "Netherlands" "New.Zealand"</span>
<span class="co">#&gt; [21] "Norway"      "Poland"      "Portugal"    "Spain"       "Sweden"     </span>
<span class="co">#&gt; [26] "UK"          "Ukraine"     "USA"        </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;  [1] "Algeria"              "Bangladesh"           "Belarus"             </span>
<span class="co">#&gt;  [4] "Brunei.Darussalam"    "China"                "Cuba"                </span>
<span class="co">#&gt;  [7] "Egypt"                "India"                "Indonesia"           </span>
<span class="co">#&gt; [10] "Jordan"               "Kuwait"               "Libya"               </span>
<span class="co">#&gt; [13] "Malaysia"             "Pakistan"             "Russian.Federation"  </span>
<span class="co">#&gt; [16] "Sri.Lanka"            "Sudan"                "Syrian.Arab.Republic"</span>
<span class="co">#&gt; [19] "Venezuela"           </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;  [1] "Argentina"           "Bahamas"             "Bolivia"            </span>
<span class="co">#&gt;  [4] "Botswana"            "Brazil"              "Burkina.Faso"       </span>
<span class="co">#&gt;  [7] "Chile"               "Colombia"            "Costa.Rica"         </span>
<span class="co">#&gt; [10] "Ecuador"             "Ethiopia"            "Ghana"              </span>
<span class="co">#&gt; [13] "Guyana"              "Jamaica"             "Kenya"              </span>
<span class="co">#&gt; [16] "Mali"                "Mexico"              "Nepal"              </span>
<span class="co">#&gt; [19] "Nigeria"             "Panama"              "Paraguay"           </span>
<span class="co">#&gt; [22] "Peru"                "Philippines"         "Singapore"          </span>
<span class="co">#&gt; [25] "Tanzania"            "Thailand"            "Togo"               </span>
<span class="co">#&gt; [28] "Trinidad.and.Tobago" "Uruguay"             "Zambia"</span></code></pre></div>
<p>It is easier to compare these 2 sets of clusters
if we show them on a map. We first find the
cluster labels corresponding to 3 clusters
using Euclidean and <span class="math inline">\(L_1\)</span> distances:</p>
<div class="sourceCode" id="cb372"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">un.hc</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="va">labs.l1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cutree.html">cutree</a></span><span class="op">(</span><span class="va">un.hc.l1</span>, k <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>We can now use these labels to color a map, as
we did previously. For the Euclidean distances
we obtain:</p>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/AndySouth/rworldmap/">rworldmap</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/countrycode/">countrycode</a></span><span class="op">)</span>
<span class="va">these</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://vincentarelbundock.github.io/countrycode/reference/countrycode.html">countrycode</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, <span class="st">"country.name"</span>, <span class="st">"iso3c"</span><span class="op">)</span>
<span class="va">malDF</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>country <span class="op">=</span> <span class="va">these</span>, cluster <span class="op">=</span> <span class="va">labs</span><span class="op">)</span>
<span class="va">malMap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rworldmap/man/joinCountryData2Map.html">joinCountryData2Map</a></span><span class="op">(</span><span class="va">malDF</span>, joinCode <span class="op">=</span> <span class="st">"ISO3"</span>, nameJoinColumn <span class="op">=</span> <span class="st">"country"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mai <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, xaxs <span class="op">=</span> <span class="st">"i"</span>, yaxs <span class="op">=</span> <span class="st">"i"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/rworldmap/man/mapCountryData.html">mapCountryData</a></span><span class="op">(</span><span class="va">malMap</span>,
  nameColumnToPlot <span class="op">=</span> <span class="st">"cluster"</span>, catMethod <span class="op">=</span> <span class="st">"categorical"</span>,
  missingCountryCol <span class="op">=</span> <span class="st">"white"</span>, addLegend <span class="op">=</span> <span class="cn">FALSE</span>, mapTitle <span class="op">=</span> <span class="st">""</span>,
  colourPalette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"hotpink"</span>, <span class="st">"tomato"</span>, <span class="st">"blueviolet"</span>, <span class="st">"yellow"</span><span class="op">)</span>,
  oceanCol <span class="op">=</span> <span class="st">"dodgerblue"</span>
<span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="54-hclust_files/figure-html/unvotes.maps.1-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>While with the <span class="math inline">\(L_1\)</span> distances we get:</p>
<div class="inline-figure"><img src="54-hclust_files/figure-html/unvotes.maps.2.2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Recall that, as discussed in class, the analyses above may be
questionable, because these distance measures do not take into
account the actual nature of the available features.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="model-based-clustering.html"><span class="header-section-number">22</span> Model based clustering</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#hierarchical-clustering"><span class="header-section-number">23</span> Hierarchical clustering</a></li>
<li><a class="nav-link" href="#breweries-example"><span class="header-section-number">23.1</span> Breweries example</a></li>
<li><a class="nav-link" href="#languages-example"><span class="header-section-number">23.2</span> Languages example</a></li>
<li><a class="nav-link" href="#cancer-example-1"><span class="header-section-number">23.3</span> Cancer example</a></li>
<li><a class="nav-link" href="#nations-example"><span class="header-section-number">23.4</span> Nations example</a></li>
<li><a class="nav-link" href="#un-votes"><span class="header-section-number">23.5</span> UN Votes</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/ubc-stat/stat-406-worksheets/blob/main/54-hclust.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/ubc-stat/stat-406-worksheets/edit/main/54-hclust.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>UBC Stat 406 Worksheets</strong>" was written by Daniel J. McDonald and Matías Salibán-Barrera. It was last built on 2021-09-02.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
