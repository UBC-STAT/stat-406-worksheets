<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>17 Boosting (a Statistical Learning perspective) | UBC Stat 406 Worksheets</title>
<meta name="author" content="Daniel J. McDonald and Matías Salibán-Barrera">
<meta name="description" content="In these notes we will discuss boosting. Our starting point is one its first incarnations (the Adaboost.M1 algorithm). Our goal here is two-fold: introduce boosting as a different way of building...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="17 Boosting (a Statistical Learning perspective) | UBC Stat 406 Worksheets">
<meta property="og:type" content="book">
<meta property="og:description" content="In these notes we will discuss boosting. Our starting point is one its first incarnations (the Adaboost.M1 algorithm). Our goal here is two-fold: introduce boosting as a different way of building...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="17 Boosting (a Statistical Learning perspective) | UBC Stat 406 Worksheets">
<meta name="twitter:description" content="In these notes we will discuss boosting. Our starting point is one its first incarnations (the Adaboost.M1 algorithm). Our goal here is two-fold: introduce boosting as a different way of building...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">UBC Stat 406 Worksheets</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Preface</a></li>
<li class="book-part">Module 0 – Review</li>
<li><a class="" href="predictions-using-a-linear-model.html"><span class="header-section-number">1</span> Predictions using a linear model</a></li>
<li class="book-part">Module 1 – Model Selection</li>
<li><a class="" href="predictions-using-a-linear-model-continued.html"><span class="header-section-number">2</span> Predictions using a linear model (continued)</a></li>
<li><a class="" href="cross-validation-concerns.html"><span class="header-section-number">3</span> Cross-validation concerns</a></li>
<li><a class="" href="comparing-models.html"><span class="header-section-number">4</span> Comparing models</a></li>
<li class="book-part">Module 2 – Regression</li>
<li><a class="" href="ridge-regression.html"><span class="header-section-number">5</span> Ridge regression</a></li>
<li><a class="" href="lasso.html"><span class="header-section-number">6</span> LASSO</a></li>
<li><a class="" href="non-parametric-regression.html"><span class="header-section-number">7</span> Non-parametric regression</a></li>
<li><a class="" href="kernel-regression-local-regression.html"><span class="header-section-number">8</span> Kernel regression / local regression</a></li>
<li><a class="" href="regression-trees.html"><span class="header-section-number">9</span> Regression trees</a></li>
<li><a class="" href="pruning-regression-trees-with-rpart.html"><span class="header-section-number">10</span> Pruning regression trees with rpart</a></li>
<li class="book-part">Module 3 – Classification</li>
<li><a class="" href="parametric-classifiers.html"><span class="header-section-number">11</span> Parametric classifiers</a></li>
<li><a class="" href="qda.html"><span class="header-section-number">12</span> QDA</a></li>
<li><a class="" href="classification-trees.html"><span class="header-section-number">13</span> Classification Trees</a></li>
<li><a class="" href="bagging-for-regression.html"><span class="header-section-number">14</span> Bagging for regression</a></li>
<li><a class="" href="bagging-for-classification.html"><span class="header-section-number">15</span> Bagging for classification</a></li>
<li><a class="" href="random-forests.html"><span class="header-section-number">16</span> Random Forests</a></li>
<li><a class="active" href="boosting-a-statistical-learning-perspective.html"><span class="header-section-number">17</span> Boosting (a Statistical Learning perspective)</a></li>
<li><a class="" href="what-is-adaboost-doing-really.html"><span class="header-section-number">18</span> What is Adaboost doing, really?</a></li>
<li><a class="" href="single-layer-neural-network.html"><span class="header-section-number">19</span> Single layer neural network</a></li>
<li class="book-part">Module 5 – Unsupervised learning</li>
<li><a class="" href="introduction.html"><span class="header-section-number">20</span> Introduction</a></li>
<li><a class="" href="clustering.html"><span class="header-section-number">21</span> Clustering</a></li>
<li><a class="" href="model-based-clustering.html"><span class="header-section-number">22</span> Model based clustering</a></li>
<li><a class="" href="hierarchical-clustering.html"><span class="header-section-number">23</span> Hierarchical clustering</a></li>
<li><a class="" href="references.html">References</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="alt-pca.html"><span class="header-section-number">A</span> PCA and alternating regression</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="boosting-a-statistical-learning-perspective" class="section level1">
<h1>
<span class="header-section-number">17</span> Boosting (a Statistical Learning perspective)<a class="anchor" aria-label="anchor" href="#boosting-a-statistical-learning-perspective"><i class="fas fa-link"></i></a>
</h1>
<p>In these notes we will discuss boosting. Our starting point is one its first
incarnations (the Adaboost.M1 algorithm). Our goal here is two-fold: introduce boosting
as a <strong>different</strong> way of building an <strong>ensemble</strong> of <em>weak classifiers</em>, and
also to show how a statistical analysis of the method offers valuable
insight and opens a wide range of extensions and new methodologies.
We follow the presentation in Chapter 10 of [HTF09].</p>
<div id="a-different-kind-of-ensembles" class="section level2">
<h2>
<span class="header-section-number">17.1</span> A different kind of ensembles<a class="anchor" aria-label="anchor" href="#a-different-kind-of-ensembles"><i class="fas fa-link"></i></a>
</h2>
<p>So far in this course we have seen ensembles of classifiers
(or regression estimators) based on the idea of bagging: combininig
the predictions of a number of predictors trained on bootstrap
samples taken from the original training set. By construction
all the predictors in the ensemble are treated <em>equally</em> (e.g. 
their predictions receive the same weight when they are
combined). Another characteristic of these ensembles is
the predictors in them could be trained in parallel
(they are independent from each other).</p>
<p>Boosting algorithms go back to the late 90s. One of the first ones
to appear in the Machine Learning literature is probably <em>Adaboost.M1</em>
introduced in</p>
<blockquote>
<p>Freund, Y. and Schapire, R. (1997). A decision-theoretic generalization of
online learning and an application to boosting, <em>Journal of Computer
and System Sciences</em>, <strong>55</strong>:119-139.</p>
</blockquote>
<p>We discussed the specifics of the algorithm in class. An important
difference with the other ensembles
we discussed in class (<strong>can you name them?</strong>)
is that for <em>Adaboost.M1</em> the elements
of the ensemble are trained <strong>sequentially</strong> in such a way that
to compute the i-th predictor <span class="math inline">\(T_i\)</span> we need to have the
previous one <span class="math inline">\(T_{i-1}\)</span> available. Furthemore, the
weights in the final combination of predictions are generally
different for each member of the ensemble.</p>
<p>Here we will use the implementation available in
the <code>adabag</code> package, specifically the function
<code>boosting</code>. This function can be rather slow, but it
is a straight implementation of the Adaboost algorithm,
and it returns many useful objects (e.g. each of the
individual weak lerners, etc.) As usual, I suggest that
you invest a few minutes reading the help
pages and also <em>exploring</em> the returned objects by hand.</p>
<p>Note that Adaboost was originally proposed for 2-class
problems. To illustrate its use, we look at the
zip code digits example. We consider the problem of
building a classifier to determine whether an image
is a <em>1</em> or a <em>9</em>. We use 1-split classification
trees as our <em>weak lerners</em> in the ensemble.
Since <code>boosting</code> uses the <code>rpart</code> implementation
of classification and regression trees,
we use the function <code>rpart.control</code> to
specify the type of <em>weak lerners</em> we want.</p>
<p>We first load the full training set, and extract the
<em>7</em>’s and <em>9</em>’s. Since the original data file does
not have feature names, we create them as “V1”, “V2”,
etc.</p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">zip.train</span>, package <span class="op">=</span> <span class="st">"ElemStatLearn"</span><span class="op">)</span>
<span class="va">x.tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">zip.train</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">x.tr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">257</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">x.tr</span> <span class="op">&lt;-</span> <span class="va">x.tr</span><span class="op">[</span><span class="va">x.tr</span><span class="op">$</span><span class="va">V1</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span>, <span class="op">]</span></code></pre></div>
<p>To force <code>rpart</code> (and thus <code>boosting</code>)
to train a classification ensemble (as opposed to a
regression one) we force the response variable to
be categorical.</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x.tr</span><span class="op">$</span><span class="va">V1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">x.tr</span><span class="op">$</span><span class="va">V1</span><span class="op">)</span></code></pre></div>
<p>Now we load the <code>adabag</code> package, use <code>rpart.control</code> to force
it to use 1- or 2-split trees, and train the boosting ensemble:</p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">adabag</span><span class="op">)</span>
<span class="va">onesplit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html">rpart.control</a></span><span class="op">(</span>cp <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, maxdepth <span class="op">=</span> <span class="fl">1</span>, minsplit <span class="op">=</span> <span class="fl">0</span>, xval <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">bo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adabag/man/boosting.html">boosting</a></span><span class="op">(</span><span class="va">V1</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">x.tr</span>, boos <span class="op">=</span> <span class="cn">FALSE</span>, mfinal <span class="op">=</span> <span class="fl">500</span>, control <span class="op">=</span> <span class="va">onesplit</span><span class="op">)</span></code></pre></div>
<p>We can explore the evolution of the error rate on the training set
(the equivalent of the MSE for classifiers) using the function
<code>errorevol</code>:</p>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/adabag/man/errorevol.html">errorevol</a></span><span class="op">(</span><span class="va">bo1</span>, newdata <span class="op">=</span> <span class="va">x.tr</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="43-boosting_files/figure-html/boos1.plot-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Note that after approximately 10 iterations the error rate on the
training set drops to zero and stays there. A few questions for you:</p>
<ul>
<li>Has the algorithm converged after approximately 10 iterations?</li>
<li>Are the predictors trained after the (approximately) 10th iteration irrelevant?</li>
</ul>
<p>As we know pretty well by now, a more reliable measure of
the expected performance of the ensemble can be obtained
using a test set (or cross-validation) (<strong>what about OOB?</strong>)</p>
<p>First load the full test set, extract the cases corresponding
to the digits we are using here, and check the performance
of the predictor, including the plot of the error rate
as a function of the number of elements in the ensemble:</p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">zip.test</span>, package <span class="op">=</span> <span class="st">"ElemStatLearn"</span><span class="op">)</span>
<span class="va">x.te</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">zip.test</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">x.te</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">257</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">x.te</span> <span class="op">&lt;-</span> <span class="va">x.te</span><span class="op">[</span><span class="va">x.te</span><span class="op">$</span><span class="va">V1</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span>, <span class="op">]</span>
<span class="va">x.te</span><span class="op">$</span><span class="va">V1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">x.te</span><span class="op">$</span><span class="va">V1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">x.te</span><span class="op">$</span><span class="va">V1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bo1</span>, newdata <span class="op">=</span> <span class="va">x.te</span><span class="op">)</span><span class="op">$</span><span class="va">class</span><span class="op">)</span>
<span class="co">#&gt;    </span>
<span class="co">#&gt;       1   9</span>
<span class="co">#&gt;   1 260   4</span>
<span class="co">#&gt;   9   1 176</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/adabag/man/errorevol.html">errorevol</a></span><span class="op">(</span><span class="va">bo1</span>, newdata <span class="op">=</span> <span class="va">x.te</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="43-boosting_files/figure-html/boos2-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Just to make sure boosting is doing a good job, we
compare it with another ensemble classifier: a Random Forest.
We use the same number of elements in both ensembles
(500), even though their complexity is
very different – while boosting used <em>stumps</em> (1-split
trees), the <em>random forest trees</em> are (purposedly)
very large (deep).</p>
<p>We first train the random forest
and look at the error rates
as displayed by the <code>plot</code> method for
objects of class <code>randomForest</code>:</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">987</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stat.berkeley.edu/~breiman/RandomForests/">randomForest</a></span><span class="op">)</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">V1</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">x.tr</span><span class="op">)</span> <span class="co"># , ntree=500)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="43-boosting_files/figure-html/boos.comp-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Now we evaluate the performance of the Random Forest on the
training set by obtaining <em>fitted values</em> (“predictions” for the
observations in the training set) and looking at the
corresponding “confusion table”:</p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">x.tr</span><span class="op">$</span><span class="va">V1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">a</span>, newdata <span class="op">=</span> <span class="va">x.tr</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;    </span>
<span class="co">#&gt;        1    9</span>
<span class="co">#&gt;   1 1005    0</span>
<span class="co">#&gt;   9    0  644</span></code></pre></div>
<p>An interesting question to ask yourself at this point is: <strong>Does this
“confusion table” match the information from the error plot above?</strong>
Can you describe (and explain!) the apparent problem?</p>
<p>As we all know too well, of course, the classification error rate <em>on the test set</em>
is a better measure of predicition performance:</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pr.rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">a</span>, newdata <span class="op">=</span> <span class="va">x.te</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">x.te</span><span class="op">$</span><span class="va">V1</span>, <span class="va">pr.rf</span><span class="op">)</span>
<span class="co">#&gt;    pr.rf</span>
<span class="co">#&gt;       1   9</span>
<span class="co">#&gt;   1 259   5</span>
<span class="co">#&gt;   9   1 176</span></code></pre></div>
<p>We see that in this case the random forest does marginally worse
than the boosting ensemble, even though the ensemble elements
using in boosting are extremely simple trees.</p>
<div id="another-example-1" class="section level3">
<h3>
<span class="header-section-number">17.1.1</span> Another example<a class="anchor" aria-label="anchor" href="#another-example-1"><i class="fas fa-link"></i></a>
</h3>
<p>Consider the ISOLET data introduced earlier. Here we will consider
building a classifier to discriminate between the letters <em>A</em> and <em>H</em>
based on the features extracted from their sound recordings.
The steps of the analysis are the same as before:</p>
<p>First we load the training set</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xtr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/isolet-train-a-h.data"</span>, sep <span class="op">=</span> <span class="st">","</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p>Next, we force the response to be a categorical variable:</p>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">xtr</span><span class="op">$</span><span class="va">V618</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">xtr</span><span class="op">$</span><span class="va">V618</span><span class="op">)</span></code></pre></div>
<p>Now train a boosting ensamble and evaluate it on the test set
(which needs to be loaded as well):</p>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">onesplit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html">rpart.control</a></span><span class="op">(</span>cp <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, maxdepth <span class="op">=</span> <span class="fl">1</span>, minsplit <span class="op">=</span> <span class="fl">0</span>, xval <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="va">bo1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adabag/man/boosting.html">boosting</a></span><span class="op">(</span><span class="va">V618</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">xtr</span>, boos <span class="op">=</span> <span class="cn">FALSE</span>, mfinal <span class="op">=</span> <span class="fl">200</span>, control <span class="op">=</span> <span class="va">onesplit</span><span class="op">)</span>
<span class="va">xte</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/isolet-test-a-h.data"</span>, sep <span class="op">=</span> <span class="st">","</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">xte</span><span class="op">$</span><span class="va">V618</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">xte</span><span class="op">$</span><span class="va">V618</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xte</span><span class="op">$</span><span class="va">V618</span>, <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">bo1</span>, newdata <span class="op">=</span> <span class="va">xte</span><span class="op">)</span><span class="op">$</span><span class="va">class</span><span class="op">)</span>
<span class="co">#&gt;    </span>
<span class="co">#&gt;      1  8</span>
<span class="co">#&gt;   1 59  1</span>
<span class="co">#&gt;   8  0 60</span></code></pre></div>
<p>We can also look at the error evolution on the test set to decide whether
a smaller ensemble would be satisfactory:</p>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/adabag/man/errorevol.html">errorevol</a></span><span class="op">(</span><span class="va">bo1</span>, newdata <span class="op">=</span> <span class="va">xte</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="43-boosting_files/figure-html/boos4.4-1.png" width="90%" style="display: block; margin: auto;"></div>
<p>Finally, we compare these results with those obtained with a Random Forest:</p>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">a.rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span><span class="op">(</span><span class="va">V618</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">xtr</span>, ntree <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">a.rf</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="43-boosting_files/figure-html/boos4.5-1.png" width="90%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p.rf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">a.rf</span>, newdata <span class="op">=</span> <span class="va">xte</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">xte</span><span class="op">$</span><span class="va">V618</span>, <span class="va">p.rf</span><span class="op">)</span>
<span class="co">#&gt;    p.rf</span>
<span class="co">#&gt;      1  8</span>
<span class="co">#&gt;   1 58  2</span>
<span class="co">#&gt;   8  0 60</span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="random-forests.html"><span class="header-section-number">16</span> Random Forests</a></div>
<div class="next"><a href="what-is-adaboost-doing-really.html"><span class="header-section-number">18</span> What is Adaboost doing, really?</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#boosting-a-statistical-learning-perspective"><span class="header-section-number">17</span> Boosting (a Statistical Learning perspective)</a></li>
<li>
<a class="nav-link" href="#a-different-kind-of-ensembles"><span class="header-section-number">17.1</span> A different kind of ensembles</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#another-example-1"><span class="header-section-number">17.1.1</span> Another example</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>UBC Stat 406 Worksheets</strong>" was written by Daniel J. McDonald and Matías Salibán-Barrera. It was last built on 2021-08-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
